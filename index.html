
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>体重管理アプリ</title>
    
    <!-- カスタムスタイル -->
    <link rel="stylesheet" href="custom/styles.css">
    
    <!-- タブ固有スタイル -->
    <link rel="stylesheet" href="tabs/tab3-room-cleaning/room-cleaning.css">
    <link rel="stylesheet" href="tabs/tab4-stretch/tab-stretch.css">
    <link rel="stylesheet" href="tabs/tab8-memo-list/memo-list.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <!-- Chart.js with date adapter -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    
    <!-- カスタム設定 -->
    <script type="module" src="custom/app-config.js"></script>
    
    <!-- 共通JavaScript関数 -->
    <script src="shared/common-functions.js"></script>
    
    <!-- 共通ユーティリティ -->
    <script src="shared/utils/validation.js"></script>
    <script src="shared/utils/custom-items.js"></script>
    <script src="shared/utils/data-operations.js"></script>
    
    <!-- 共通コンポーネント -->
    <script src="shared/components/dom-utils.js"></script>
    <script src="shared/components/mode-control.js"></script>
    
    <!-- タブ固有JavaScript -->
    <!-- タブ用JSは動的読み込みのためstatic読み込み削除 -->
    <style>
        body { font-family: Arial, sans-serif; padding: 2px; background: #f5f5f5; line-height: 1.2; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 6px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        
        /* 文字数別ボタン幅調整 */
        .timing-btn[data-timing*="帰宅:食事有+半日(7時間以上)"],
        .timing-btn[data-timing*="ある程度飲んだ後"] {
            width: 200px !important; /* 3ボタン分 */
            flex-shrink: 0;
        }
        .timing-btn[data-timing*="帰宅:食事無し"],
        .timing-btn[data-timing*="帰宅後"] {
            width: 140px !important; /* 2ボタン分 */
            flex-shrink: 0;
        }
        
        /* スマホ対応 */
        @media (max-width: 768px) {
            body { padding: 3px; }
            .container { padding: 8px; margin: 0; border-radius: 0; }
            .weight-input { grid-template-columns: 1fr; gap: 8px; }
            .input-card { padding: 8px; }
        }
        .auth-section { background: #e7f3ff; color: #0c5460; padding: 6px; border-radius: 5px; margin-bottom: 6px; text-align: center; }
        .weight-input { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; margin: 8px 0; }
        .input-card { border: 1px solid #ddd; padding: 8px; border-radius: 8px; }
        
        /* メモリスト用スタイル */
        .memo-item {
            border: 1px solid #ddd;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            background: #fefefe;
        }
        .memo-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 5px;
        }
        .memo-category {
            background: #6c757d;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            margin-right: 5px;
        }
        .memo-date {
            color: #666;
            font-size: 11px;
        }
        .memo-text {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 14px;
            line-height: 1.4;
            color: #333;  /* 文字を濃くして読みやすく */
            font-weight: 500;  /* やや太めにして視認性向上 */
        }
        .memo-delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 2px 6px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 10px;
            margin-left: 10px;
        }
        .memo-delete-btn:hover {
            background: #c82333;
        }
        
        /* タイミングパネルのスタイル */
        .timing-panel { 
            background: #f8f9fa; 
            border: 2px solid #e9ecef; 
            border-radius: 8px; 
            padding: 8px; 
            margin: 5px 0; 
        }
        .timing-buttons { 
            display: flex; 
            gap: 4px; 
            flex-wrap: wrap; 
            justify-content: center;
        }
        .timing-btn { 
            background: #6c757d; 
            color: white; 
            border: none; 
            padding: 6px 8px; 
            border-radius: 12px; 
            cursor: pointer; 
            font-size: 11px;
            transition: all 0.2s;
            min-width: 85px;
            text-align: center;
            flex: 1;
            max-width: 120px;
        }
        .timing-btn:hover {
            transform: scale(1.05);
        }
        .timing-btn.selected {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        @media (max-width: 768px) {
            .timing-buttons { gap: 3px; }
            .timing-btn { 
                padding: 4px 6px; 
                font-size: 10px;
                min-width: 75px;
            }
        }

        /* 服装ボタンのスタイル統一 */
        .clothing-btn {
            border: none;
            padding: 6px 8px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 10px;
            min-width: 85px;
            text-align: center;
            transition: all 0.2s;
            flex: 1;
            max-width: 120px;
        }
        .clothing-btn:hover {
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            .clothing-btn {
                padding: 4px 6px;
                min-width: 75px;
                font-size: 9px;
            }
        }
        .input-field { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin: 5px 0; font-size: 16px; }
        .save-button { background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; margin: 5px; font-size: 16px; }
        .save-button:hover { background: #218838; }
        .auth-button { background: #4285f4; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        .auth-button:hover { background: #357ae8; }
        .logout-button { background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin: 5px; }
        .data-area { background: #f8f9fa; border: 1px solid #dee2e6; padding: 8px; border-radius: 5px; font-family: monospace; min-height: 120px; }
        .hidden { display: none; }
        .user-info { background: #d4edda; color: #155724; padding: 4px 6px; border-radius: 5px; margin-bottom: 6px; font-size: 13px; }
    </style>
</head>
<body>
    <div class="container">
        <!-- ユーザー情報表示（一番上） -->
        <div class="user-info hidden" id="userInfo" style="margin-bottom: 10px;">
            <span>👤 ログイン中: <span id="userName"></span></span>
            <button class="logout-button" onclick="handleLogout()">ログアウト</button>
        </div>

        <!-- タブナビゲーション -->
        <div id="tabNavigation" class="hidden" style="margin-bottom: 15px;">
            <div style="display: flex; border-bottom: 2px solid #ddd; flex-wrap: wrap;">
                <button id="tab1" class="tab-btn active" onclick="switchTab(1)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #007bff; color: white; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">体重</button>
                <button id="tab2" class="tab-btn" onclick="switchTab(2)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">睡眠</button>
                <button id="tab3" class="tab-btn" onclick="switchTab(3)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">部屋片づけ</button>
                <button id="tab4" class="tab-btn" onclick="switchTab(4)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">ストレッチ</button>
                <button id="tab5" class="tab-btn" onclick="switchTab(5)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">xx5</button>
                <button id="tab6" class="tab-btn" onclick="switchTab(6)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">xx6</button>
                <button id="tab7" class="tab-btn" onclick="switchTab(7)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">xx7</button>
                <button id="tab8" class="tab-btn" onclick="switchTab(8)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">メモリスト</button>
            </div>
            <!-- 2行目のタブ（9-16） -->
            <div style="display: flex; border-bottom: 2px solid #ddd; flex-wrap: wrap;">
                <button id="tab9" class="tab-btn" onclick="switchTab(9)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">xx9</button>
                <button id="tab10" class="tab-btn" onclick="switchTab(10)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">xx10</button>
                <button id="tab11" class="tab-btn" onclick="switchTab(11)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">xx11</button>
                <button id="tab12" class="tab-btn" onclick="switchTab(12)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">xx12</button>
                <button id="tab13" class="tab-btn" onclick="switchTab(13)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">xx13</button>
                <button id="tab14" class="tab-btn" onclick="switchTab(14)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">xx14</button>
                <button id="tab15" class="tab-btn" onclick="switchTab(15)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-right: 1px; margin-bottom: 1px; font-size: 12px;">xx15</button>
                <button id="tab16" class="tab-btn" onclick="switchTab(16)" style="flex: 1; min-width: 80px; padding: 8px 10px; border: none; background: #f8f9fa; color: #495057; cursor: pointer; border-radius: 5px 5px 0 0; margin-bottom: 1px; font-size: 12px;">xx16</button>
            </div>
        </div>

        <!-- アプリタイトル -->
        <div class="app-header hidden" id="appHeader">
            <h1 class="app-title" id="appTitle">📊 体重管理アプリ</h1>
            <p class="app-subtitle">Core/Customフォルダ分離版 - Firebase + Google認証</p>
        </div>

        <!-- 認証セクション -->
        <div class="auth-section" id="authSection">
            <h1 class="app-title">📊 体重管理アプリ</h1>
            <p class="app-subtitle">Core/Customフォルダ分離版 - Firebase + Google認証</p>
            <h3>🔐 ログイン</h3>
            <p>Googleアカウントでログインしてデータを保存・同期できます</p>
            <button class="auth-button" onclick="handleGoogleLogin()">Googleでログイン</button>
        </div>

        <!-- タブコンテンツ -->
        <div id="tabContent1" class="tab-content">
            <!-- 体重管理コンテンツは動的読み込み -->
        </div>

        <!-- 共通ログエリア（全タブ用） -->
        <div class="hidden" id="globalLogArea">
            <h3>📋 アプリログ <button class="universal-copy-btn" onclick="copyLogs()" style="background: #28a745; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 12px;">📋 ログをコピー</button></h3>
            <div class="data-area" id="logArea">
                アプリテンプレート起動完了...<br>
                🔥 Firebase設定完了<br>
                🔐 Google認証準備完了<br>
            </div>
            
            <!-- デバッグボタンエリア -->
            <div style="margin-top: 8px; text-align: center;">
                <button class="universal-copy-btn" onclick="debugFirebaseConnection()" style="background: #ff6b6b; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">🔍 Firebase Debug</button>
                <button class="universal-copy-btn" onclick="checkLoginIssues()" style="background: #ffc107; color: #212529; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">⚠️ ログイン問題診断</button>
                <button class="universal-copy-btn" onclick="copyDebugInfo()" style="background: #17a2b8; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">📋 デバッグ情報をコピー</button>
                <button class="universal-copy-btn" onclick="checkDatabaseStructure()" style="background: #6f42c1; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">🏗️ DB構造確認</button>
                <button class="universal-copy-btn" onclick="checkMobileSupport()" style="background: #28a745; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">📱 モバイル診断</button>
                <button class="universal-copy-btn" onclick="forceAuthCheck()" style="background: #fd7e14; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">🔄 認証状態確認</button>
                <button class="universal-copy-btn" onclick="checkFirebaseConfig()" style="background: #dc3545; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">🔧 Firebase設定</button>
                <button class="universal-copy-btn" onclick="testPopup()" style="background: #20c997; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">🧪 ポップアップテスト</button>
            </div>
        </div>


        <!-- タブコンテンツ2 -->
        <div id="tabContent2" class="tab-content hidden">
            <!-- コンテンツは動的読み込み -->
        </div>

        <!-- タブコンテンツ3 -->
        <div id="tabContent3" class="tab-content hidden">
            <!-- コンテンツは動的読み込み -->
        </div>

        <!-- タブコンテンツ4: ストレッチ -->
        <div id="tabContent4" class="tab-content hidden">
            <!-- ストレッチコンテンツは動的読み込み -->
        </div>

        <!-- タブコンテンツ5 -->
        <div id="tabContent5" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx5</h3>
                <p>こちらのコンテンツは後で実装予定です</p>
            </div>
        </div>

        <!-- タブコンテンツ6 -->
        <div id="tabContent6" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx6</h3>
                <p>こちらのコンテンツは後で実装予定です</p>
            </div>
        </div>

        <!-- タブコンテンツ7 -->
        <div id="tabContent7" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx7</h3>
                <p>こちらのコンテンツは後で実装予定です</p>
            </div>
        </div>

        <!-- タブコンテンツ8: メモリスト -->
        <div id="tabContent8" class="tab-content hidden">
            <!-- コンテンツは動的読み込み -->
        </div>

        <!-- タブ9-16の空コンテンツ -->
        <div id="tabContent9" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx9</h3>
                <p>このタブはまだ実装されていません</p>
            </div>
        </div>

        <div id="tabContent10" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx10</h3>
                <p>このタブはまだ実装されていません</p>
            </div>
        </div>

        <div id="tabContent11" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx11</h3>
                <p>このタブはまだ実装されていません</p>
            </div>
        </div>

        <div id="tabContent12" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx12</h3>
                <p>このタブはまだ実装されていません</p>
            </div>
        </div>

        <div id="tabContent13" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx13</h3>
                <p>このタブはまだ実装されていません</p>
            </div>
        </div>

        <div id="tabContent14" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx14</h3>
                <p>このタブはまだ実装されていません</p>
            </div>
        </div>

        <div id="tabContent15" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx15</h3>
                <p>このタブはまだ実装されていません</p>
            </div>
        </div>

        <div id="tabContent16" class="tab-content hidden">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>🔧 xx16</h3>
                <p>このタブはまだ実装されていません</p>
            </div>
        </div>
    </div>

    <script>
        // Core Firebase設定（変更禁止 - core/src/firebase-config.js参照）
        const firebaseConfig = {
            apiKey: "AIzaSyA5PXKChizYDCXF_GJ4KL6Ylq9K5hCPXWE",
            authDomain: "shares-b1b97.firebaseapp.com",
            databaseURL: "https://shares-b1b97-default-rtdb.firebaseio.com",
            projectId: "shares-b1b97",
            storageBucket: "shares-b1b97.firebasestorage.app",
            messagingSenderId: "38311063248",
            appId: "1:38311063248:web:0d2d5726d12b305b24b8d5"
        };

        // Firebase初期化
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        let currentUser = null;
        let selectedTimingValue = '';
        let selectedTopValue = '';
        let selectedBottomValue = '';
        let weightChart = null;
        let allWeightData = [];
        window.editingEntryId = null;

        // 統一モード状態管理（外部ファイルで定義済み）

        // 前期間比較機能の状態管理

        // アプリバージョン（一元管理）
        const APP_VERSION = 'v2.04';
        
        // カラー配列定数化（3箇所の重複統一）

        // カスタム項目関連の関数は tabs/tab1-weight/tab-weight.js に移動済み





        // 統一モードシステム完了 - 古い個別関数群は削除済み









        // 認証状態の監視（改良版 + リダイレクト対応）
        auth.onAuthStateChanged(async (user) => {
            currentUser = user;
            if (user) {
                log(`✅ 認証状態確認: ${user.displayName} でログイン中`);
                log(`📧 メール: ${user.email}`);
                showUserInterface(user);
                log('🔄 体重データ読み込み開始...');
                loadUserWeightData(user.uid);
            } else {
                // リダイレクト結果をチェック（iPhone対応）
                try {
                    const result = await auth.getRedirectResult();
                    if (result.user) {
                        log(`✅ リダイレクトログイン成功: ${result.user.displayName}`);
                    }
                } catch (error) {
                    // リダイレクトエラーは無視（初回アクセス時など）
                }
                log('🔒 認証状態: 未ログイン');
                showLoginInterface();
            }
        });

        // 初期化完了ログ
        log('🔄 Firebase認証システム初期化完了 - 認証状態を確認中...');

        // Googleログイン（改良版 - ポップアップブロック検知付き）
        window.handleGoogleLogin = async () => {
            try {
                log('🔐 Googleログイン開始...');
                const provider = new firebase.auth.GoogleAuthProvider();
                
                // モバイルデバイス検出（iPhone専用対応）
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                const isIPhone = /iPhone|iPad|iPod/i.test(navigator.userAgent);
                
                // iPhoneはリダイレクト方式、それ以外はポップアップ方式
                if (isIPhone) {
                    log('📱 iPhone/iPad検出 - リダイレクト方式でログイン（Safari対応）');
                    log('🔄 ページがGoogleに移動します...');
                    // リダイレクト方式（iPhone専用）
                    await auth.signInWithRedirect(provider);
                    return; // リダイレクトするのでここで終了
                } else if (isMobile) {
                    log('📱 モバイルデバイス検出 - ポップアップ方式でログイン');
                    log('💡 ポップアップが途中で止まる場合は、ブラウザ設定の確認が必要です');
                } else {
                    log('🖥️ デスクトップデバイス - ポップアップ方式でログイン');
                }
                
                // ポップアップブロック検知のためのタイムアウト設定（iPhone以外）
                log('🪟 ポップアップウィンドウでGoogleログインを開始...');
                
                const loginPromise = auth.signInWithPopup(provider);
                
                // タイムアウト検知（15秒でポップアップが開かない場合）
                const timeoutPromise = new Promise((_, reject) => {
                    setTimeout(() => {
                        reject(new Error('ポップアップタイムアウト - ブロックされた可能性があります'));
                    }, 15000);  // 元の15秒に戻す（iPhone以外用）
                });
                
                try {
                    const result = await Promise.race([loginPromise, timeoutPromise]);
                    log(`✅ ログイン成功: ${result.user.displayName}`);
                } catch (raceError) {
                    // タイムアウトの場合の特別処理
                    if (raceError.message.includes('タイムアウト')) {
                        log('⏰ ポップアップが15秒以内に開きませんでした');
                        log('🔄 ポップアップブロック検知 - 解決方法をご案内します');
                        throw new Error('POPUP_TIMEOUT');
                    } else {
                        throw raceError;
                    }
                }
                
            } catch (error) {
                log(`❌ ログインエラー: ${error.message}`);
                
                // エラーの詳細情報をログに出力
                if (error.code) {
                    log(`- エラーコード: ${error.code}`);
                    
                    // 特定のエラーコードに対する解決策を提示
                    switch(error.code) {
                        case 'auth/unauthorized-domain':
                            log('💡 ドメイン許可設定の問題です');
                            log('💡 Firebase Consoleで認証ドメインを確認してください');
                            break;
                        case 'auth/popup-blocked':
                            log('💡 ポップアップがブロックされました');
                            showPopupGuide(isMobile);
                            break;
                        case 'auth/popup-closed-by-user':
                            log('💡 ユーザーがポップアップを閉じました');
                            log('💡 もう一度ログインボタンを押してください');
                            break;
                        case 'auth/cancelled-popup-request':
                            log('💡 前回のポップアップがキャンセルされました');
                            log('💡 しばらく待ってから再試行してください');
                            break;
                        default:
                            if (error.message === 'POPUP_TIMEOUT') {
                                log('⚠️ ポップアップが途中で止まりました');
                                showPopupGuide(isMobile);
                            } else {
                                log('💡 ブラウザを更新してもう一度お試しください');
                            }
                    }
                } else if (error.message === 'POPUP_TIMEOUT') {
                    showPopupGuide(isMobile);
                }
                
                if (error.credential) {
                    log('- 認証情報は取得済み');
                }
            }
        };

        // ポップアップ許可ガイド表示
        function showPopupGuide(isMobile) {
            log('📖 === ポップアップ許可ガイド ===');
            if (isMobile) {
                log('📱 スマートフォン向け解決手順:');
                log('1. ページ上部のアドレスバーに表示される「ポップアップがブロックされました」をタップ');
                log('2. または、ブラウザメニュー(⋮) → 設定 → サイト設定 → ポップアップとリダイレクト → 許可');
                log('3. Chrome: 右上⋮メニュー → 設定 → 詳細設定 → サイト設定 → ポップアップとリダイレクト');
                log('4. Safari: 設定アプリ → Safari → ポップアップブロック → オフ');
                log('5. 設定後、このページを更新してもう一度ログインボタンを押してください');
            } else {
                log('💻 PC向け解決手順:');
                log('1. アドレスバー右端のアイコン(🚫)をクリック → 許可');
                log('2. または、ブラウザ設定 → プライバシーとセキュリティ → ポップアップとリダイレクト → 許可');
            }
            log('💡 それでも解決しない場合: プライベートモードを終了するか、別のブラウザをお試しください');
            log('🔄 ポップアップ設定を確認したら、再度「Googleでログイン」ボタンを押してください');
            log('📖 ========================');
        }

        // ポップアップテスト機能
        window.testPopup = () => {
            log('🧪 ポップアップテスト開始...');
            
            try {
                const testWindow = window.open('', '_blank', 'width=400,height=500');
                
                if (testWindow) {
                    log('✅ ポップアップ許可済み - ログイン可能です');
                    testWindow.close();
                    log('💡 「Googleでログイン」ボタンを押してください');
                } else {
                    log('❌ ポップアップがブロックされています');
                    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                    showPopupGuide(isMobile);
                }
            } catch (error) {
                log(`❌ ポップアップテストエラー: ${error.message}`);
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                showPopupGuide(isMobile);
            }
        };

        // ログアウト
        window.handleLogout = async () => {
            try {
                await auth.signOut();
                // loadCustomItems実行フラグをリセット（次回ログイン時に再実行可能にする）
                isLoadCustomItemsExecuted = false;
                log('📤 ログアウト完了 (カスタム項目フラグリセット済み)');
            } catch (error) {
                log(`❌ ログアウトエラー: ${error.message}`);
            }
        };



        // ユーザーのデータを読み込み
        // loadUserWeightData関数は tabs/tab1-weight/tab-weight.js に移動済み

        // グラフを更新










        // 現在のタブ
        let currentTab = 1;
        
        // タブコンテンツ動的読み込み
        window.loadTabContent = async (tabNumber, tabType) => {
            try {
                const tabContentDiv = document.getElementById(`tabContent${tabNumber}`);
                if (!tabContentDiv) return;
                
                // HTMLコンテンツを読み込み
                const response = await fetch(`tabs/tab${tabNumber}-${tabType}/tab-${tabType}.html`);
                if (response.ok) {
                    const htmlContent = await response.text();
                    tabContentDiv.innerHTML = htmlContent;
                    
                    // JavaScriptファイルを動的読み込み
                    await loadTabScript(tabNumber, tabType);
                    
                    // タブ固有の初期化処理（JSファイル読み込み完了後）
                    if (tabNumber === 1 && currentUser) {
                        log(`🔄 tab1: 体重管理タブ初期化実行`);
                        
                        // 外部JSファイルの初期化関数を呼び出し
                        setTimeout(() => {
                            if (typeof window.initWeightTab === 'function') {
                                window.initWeightTab();
                                log('✅ 体重管理タブ初期化完了');
                            } else {
                                log('❌ initWeightTab関数が見つかりません');
                            }
                        }, 200);
                    } else if (tabNumber === 3 && currentUser) {
                        log('🔄 部屋片付けタブ: JS読み込み完了後のデータ読み込み開始');
                        setTimeout(() => {
                            if (typeof window.loadRoomData === 'function') {
                                window.loadRoomData();
                                log('✅ 部屋片付けデータ読み込み実行');
                            } else if (typeof loadRoomData === 'function') {
                                loadRoomData();
                                log('✅ 部屋片付けデータ読み込み実行（ローカル関数）');
                            } else {
                                log('❌ loadRoomData関数が見つかりません');
                            }
                        }, 200); // 少し長めの待機時間
                    } else if (tabNumber === 8 && currentUser) {
                        log('🔄 メモリストタブ: JS読み込み完了後のデータ読み込み開始');
                        setTimeout(() => {
                            loadMemoData();
                        }, 100);
                    }
                    
                    log(`✅ タブ${tabNumber}（${tabType}）コンテンツ読み込み完了`);
                } else {
                    log(`⚠️ タブ${tabNumber}の分離ファイルが見つかりません - 既存コンテンツを使用`);
                }
            } catch (error) {
                log(`❌ タブ読み込みエラー: ${error.message}`);
            }
        };
        
        // タブ用JavaScriptの動的読み込み
        window.loadTabScript = async (tabNumber, tabType) => {
            try {
                // 既存のスクリプトタグを削除
                const existingScript = document.getElementById(`tab${tabNumber}Script`);
                if (existingScript) {
                    existingScript.remove();
                }
                
                // 新しいスクリプトタグを作成
                const script = document.createElement('script');
                script.id = `tab${tabNumber}Script`;
                script.src = `tabs/tab${tabNumber}-${tabType}/tab-${tabType}.js`;
                document.head.appendChild(script);
                
                return new Promise((resolve, reject) => {
                    script.onload = () => resolve();
                    script.onerror = () => reject(new Error(`Script load failed: ${script.src}`));
                });
            } catch (error) {
                throw error;
            }
        };

        // タブ切り替え機能（動的読み込み対応）
        window.switchTab = async (tabNumber) => {
            currentTab = tabNumber;
            
            // 現在のタブを localStorage に保存
            localStorage.setItem('currentTab', tabNumber);
            
            // すべてのタブボタンを非アクティブに（16タブ対応）
            for (let i = 1; i <= 16; i++) {
                const tabBtn = document.getElementById(`tab${i}`);
                const tabContent = document.getElementById(`tabContent${i}`);
                
                log(`🔍 タブ${i}: ボタン=${tabBtn ? '存在' : 'なし'}, コンテンツ=${tabContent ? '存在' : 'なし'}`);
                
                if (i === tabNumber) {
                    // アクティブタブ
                    if (tabBtn) {
                        tabBtn.style.background = '#007bff';
                        tabBtn.style.color = 'white';
                    }
                    if (tabContent) {
                        tabContent.classList.remove('hidden');
                        log(`✅ タブ${i}コンテンツを表示`);
                    }
                    
                    // 動的読み込み（全分離タブ統一）
                    if (i === 1) {
                        await loadTabContent(1, 'weight');
                    } else if (i === 2) {
                        await loadTabContent(2, 'sleep');
                    } else if (i === 3) {
                        await loadTabContent(3, 'room-cleaning');
                    } else if (i === 4) {
                        await loadTabContent(4, 'stretch');
                    } else if (i === 8) {
                        await loadTabContent(8, 'memo-list');
                    }
                } else {
                    // 非アクティブタブ
                    if (tabBtn) {
                        tabBtn.style.background = '#f8f9fa';
                        tabBtn.style.color = '#495057';
                    }
                    if (tabContent) {
                        tabContent.classList.add('hidden');
                        log(`❌ タブ${i}コンテンツを非表示`);
                    }
                }
            }
            
            // タイトル更新
            const tabTitles = {
                1: '📊 体重管理アプリ',
                2: '🛏️ 睡眠管理',
                3: '🏠 部屋片づけ',
                4: '🤸 ストレッチ',
                5: '🔧 xx5',
                6: '🔧 xx6', 
                7: '🔧 xx7',
                8: '📝 メモリスト'
            };
            
            const titleElement = document.getElementById('appTitle');
            if (titleElement && tabTitles[tabNumber]) {
                titleElement.textContent = `${tabTitles[tabNumber]} ${APP_VERSION}`;
            }
            
            // 体重管理要素は常に表示（tabContent1内にあるため自動制御される）
            
            // タブ固有の初期化処理
            if (tabNumber === 1) {
                // 体重管理タブの初期化（外部JSで処理）
                if (currentUser && typeof window.initWeightTab === 'function') {
                    log('🔄 体重管理タブ: 外部JS初期化実行');
                    window.initWeightTab();
                }
            } else if (tabNumber === 2) {
                // 睡眠管理タブの初期化（ログインに関係なく実行）
                initializeSleepManager();
                if (currentUser) {
                    loadSleepData();
                }
            } else if (tabNumber === 3) {
                // 部屋片付けタブの初期化（データ読み込みはloadTabContent完了後に実行）
                log('🔄 部屋片付けタブに切り替え - 初期化のみ実行');
                initRoomManagement();
            } else if (tabNumber === 8) {
                // メモリストタブの初期化（データ読み込みはloadTabContent完了後に実行）
                log('🔄 メモリストタブに切り替え - 初期化のみ実行');
            }
            
            log(`📑 タブ切り替え: タブ${tabNumber}`);
        };

        // UI表示制御
        function showUserInterface(user) {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('tabNavigation').classList.remove('hidden');
            document.getElementById('appHeader').classList.remove('hidden');
            // 体重管理関連要素は存在チェック後に表示
            const modeControl = document.getElementById('modeControl');
            if (modeControl) modeControl.classList.remove('hidden');
            
            const weightInput = document.getElementById('weightInput');
            if (weightInput) weightInput.classList.remove('hidden');
            
            const chartPanel = document.getElementById('chartPanel');
            if (chartPanel) chartPanel.classList.remove('hidden');
            
            const weightHistoryPanel = document.getElementById('weightHistoryPanel');
            if (weightHistoryPanel) weightHistoryPanel.classList.remove('hidden');
            document.getElementById('userName').textContent = user.displayName;
            
            // 保存されたタブまたはデフォルトでタブ1を表示
            const savedTab = localStorage.getItem('currentTab');
            const tabToShow = savedTab ? parseInt(savedTab) : 1;
            switchTab(tabToShow);
            
            // 日付初期化は各タブの外部JSファイルで実行
            
            // メモデータを読み込み（ログイン時、存在チェック付き）
            if (typeof loadMemoData === 'function') {
                loadMemoData();
                log('✅ メモデータ読み込み実行');
            } else {
                log('⚠️ loadMemoData関数未定義 - 初期化時スキップ');
            }
            
            // タイミングボタンの初期状態設定
            document.querySelectorAll('.timing-btn').forEach(btn => {
                btn.style.opacity = '0.7';
                btn.classList.remove('selected');
            });
            
            // 服装ボタンの初期状態設定
            document.querySelectorAll('.clothing-btn').forEach(btn => {
                btn.style.opacity = '0.7';
                btn.style.transform = 'scale(1)';
            });
            
            // デフォルト服装選択: 上=なし, 下=トランクス
            selectClothingTop('なし');
            selectClothingBottom('トランクス');
            
        }

        function showLoginInterface() {
            document.getElementById('authSection').classList.remove('hidden');
            document.getElementById('userInfo').classList.add('hidden');
            document.getElementById('tabNavigation').classList.add('hidden');
            document.getElementById('appHeader').classList.add('hidden');
            document.getElementById('modeControl').classList.add('hidden');
            document.getElementById('weightInput').classList.add('hidden');
            document.getElementById('chartPanel').classList.add('hidden');
        }

        // ログ出力関数（安全アクセス対応）
        function log(message) {
            const logArea = document.getElementById('logArea');
            const timestamp = new Date().toLocaleTimeString();
            
            // DOM要素が存在しない場合はコンソールログのみ
            if (logArea) {
                logArea.innerHTML += `[${timestamp}] ${message}<br>`;
                logArea.scrollTop = logArea.scrollHeight;
            }
            console.log(`[${timestamp}] ${message}`);
        }


        // Firebase接続デバッグ
        window.debugFirebaseConnection = () => {
            log('🔍 === Firebase Debug 開始 ===');
            
            // 1. Firebase設定確認
            log(`🔥 Firebase Config確認:`);
            log(`- Project ID: ${firebaseConfig.projectId}`);
            log(`- Database URL: ${firebaseConfig.databaseURL}`);
            log(`- Auth Domain: ${firebaseConfig.authDomain}`);
            
            // 2. 認証状態確認
            if (currentUser) {
                log(`✅ 認証済みユーザー:`);
                log(`- UID: ${currentUser.uid.substring(0,8)}...`);
                log(`- Email: ${currentUser.email}`);
                log(`- 表示名: ${currentUser.displayName}`);
            } else {
                log('❌ 未認証状態');
            }
            
            // 3. 接続テスト
            const connectedRef = database.ref('.info/connected');
            connectedRef.once('value', (snapshot) => {
                const connected = snapshot.val();
                log(`🌐 Firebase接続状態: ${connected ? '接続中' : '未接続'}`);
                
                if (connected && currentUser) {
                    // データベーステスト
                    const testRef = database.ref(`users/${currentUser.uid}/test`);
                    testRef.set({
                        timestamp: firebase.database.ServerValue.TIMESTAMP,
                        message: 'Connection test',
                        app: 'app-template'
                    }).then(() => {
                        log('✅ データベース書き込みテスト成功');
                    }).catch((error) => {
                        log(`❌ データベース書き込みエラー: ${error.message}`);
                        log(`- Error Code: ${error.code}`);
                    });
                }
            });
            
            log('🔍 === Firebase Debug 完了 ===');
        };

        // モバイル環境診断
        window.checkMobileSupport = () => {
            log('📱 === モバイル環境診断 開始 ===');
            
            const userAgent = navigator.userAgent;
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
            
            log(`🌐 ユーザーエージェント: ${userAgent}`);
            log(`📱 モバイルデバイス判定: ${isMobile ? 'モバイル' : 'デスクトップ'}`);
            
            // ブラウザ判定
            const isChrome = /Chrome/i.test(userAgent);
            const isSafari = /Safari/i.test(userAgent) && !/Chrome/i.test(userAgent);
            const isFirefox = /Firefox/i.test(userAgent);
            
            log(`🌐 ブラウザ: ${isChrome ? 'Chrome' : isSafari ? 'Safari' : isFirefox ? 'Firefox' : '不明'}`);
            
            // ログイン方式の推奨
            if (isMobile) {
                log('💡 モバイルの推奨設定:');
                log('- Googleログインはリダイレクト方式を使用');
                log('- ポップアップブロッカーの影響なし');
                log('- 認証後にページが再読み込みされます');
            }
            
            log('📱 === モバイル環境診断 完了 ===');
        };

        // Firebase設定診断
        window.checkFirebaseConfig = () => {
            log('🔧 === Firebase設定診断 開始 ===');
            
            // 現在のドメイン確認
            const currentDomain = window.location.hostname;
            const currentUrl = window.location.href;
            log(`🌐 現在のドメイン: ${currentDomain}`);
            log(`🔗 現在のURL: ${currentUrl}`);
            
            // Firebase設定情報
            log(`🔥 Firebase設定:`);
            log(`- Project ID: ${firebaseConfig.projectId}`);
            log(`- Auth Domain: ${firebaseConfig.authDomain}`);
            log(`- Database URL: ${firebaseConfig.databaseURL}`);
            
            // 認証ドメイン許可状況の推測
            if (currentDomain === 'muumuu8181.github.io') {
                log('✅ GitHub Pagesドメイン検出');
                log('💡 Firebase Consoleでこのドメインが許可されているか確認が必要');
            } else if (currentDomain === 'localhost' || currentDomain === '127.0.0.1') {
                log('✅ ローカルホスト検出');
                log('💡 通常は自動で許可されています');
            } else {
                log('⚠️ 不明なドメインです');
                log('💡 Firebase Consoleの認証設定で許可が必要かもしれません');
            }
            
            // モバイルブラウザでのリダイレクト制限確認
            const userAgent = navigator.userAgent;
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
            
            if (isMobile) {
                log('📱 モバイルブラウザ固有の制限:');
                log('- Safari: サードパーティCookieの制限あり');
                log('- Chrome Mobile: ポップアップの自動ブロック');
                log('- 解決策: リダイレクト方式またはポップアップ許可設定');
            }
            
            log('🔧 === Firebase設定診断 完了 ===');
        };

        // 認証状態の強制確認
        window.forceAuthCheck = () => {
            log('🔍 === 認証状態強制確認 開始 ===');
            
            const user = auth.currentUser;
            log(`🔐 Firebase認証状態: ${user ? `ログイン済み (${user.displayName})` : '未ログイン'}`);
            
            if (user) {
                log('✅ ユーザー画面を表示します');
                showUserInterface(user);
                loadUserWeightData(user.uid);
            } else {
                log('❌ ログイン画面を表示します');
                showLoginInterface();
            }
            
            // 認証トークンの有効性確認
            if (user) {
                user.getIdToken(true).then(() => {
                    log('✅ 認証トークンは有効です');
                }).catch((tokenError) => {
                    log(`❌ 認証トークンエラー: ${tokenError.message}`);
                    log('💡 再ログインが必要かもしれません');
                });
            }
            
            log('🔍 === 認証状態強制確認 完了 ===');
        };

        // ログイン問題診断
        window.checkLoginIssues = () => {
            log('⚠️ === ログイン問題診断 開始 ===');
            
            // 1. プロトコルチェック
            const protocol = window.location.protocol;
            log(`🌐 現在のプロトコル: ${protocol}`);
            
            if (protocol === 'file:') {
                log('❌ 問題発見: file://プロトコルではGoogle認証が動作しません');
                log('✅ 解決方法:');
                log('  1. HTTPサーバー経由でアクセス');
                log('  2. chrome://flags で insecure origins を許可');
                log('  3. ローカルサーバー起動 (python -m http.server 8000)');
            } else if (protocol === 'https:' || protocol === 'http:') {
                log('✅ プロトコル: 問題なし');
            }
            
            // 2. Web Storage確認
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                log('✅ Web Storage: 利用可能');
            } catch (e) {
                log('❌ Web Storage: 無効');
                log('✅ 解決方法: ブラウザ設定でCookieを有効にしてください');
            }
            
            // 3. Firebaseライブラリ確認
            if (typeof firebase !== 'undefined') {
                log('✅ Firebase SDK: 読み込み済み');
                log(`- Firebase Version: ${firebase.SDK_VERSION || 'Unknown'}`);
            } else {
                log('❌ Firebase SDK: 読み込みエラー');
            }
            
            // 4. ドメイン確認
            const domain = window.location.hostname;
            log(`🏠 現在のドメイン: ${domain}`);
            
            if (domain === 'localhost' || domain === '127.0.0.1') {
                log('✅ ローカル開発: Firebase設定で許可が必要');
            }
            
            log('⚠️ === ログイン問題診断 完了 ===');
        };

        // データベース構造確認
        window.checkDatabaseStructure = async () => {
            if (!currentUser) {
                log('❌ ログインが必要です');
                return;
            }
            
            log('🏗️ === データベース構造確認 開始 ===');
            
            try {
                // 現在のユーザーのweightsデータ構造を確認
                const userRef = database.ref(`users/${currentUser.uid}/weights`);
                const snapshot = await userRef.once('value');
                const data = snapshot.val();
                
                if (data) {
                    const entries = Object.keys(data);
                    log(`📊 現在のユーザー(${currentUser.email})のデータ:`);
                    log(`- データ記録数: ${entries.length}件`);
                    log(`- 最新記録ID: ${entries[entries.length - 1]}`);
                    
                    // サンプルデータ構造を表示
                    const sampleEntry = data[entries[0]];
                    log(`- データ構造: ${JSON.stringify(sampleEntry, null, 2)}`);
                } else {
                    log('📊 現在のユーザーにはデータがありません');
                }
                
                // ルートレベルの構造確認（管理者権限が必要）
                try {
                    const rootRef = database.ref('users');
                    const rootSnapshot = await rootRef.once('value');
                    const allUsers = rootSnapshot.val();
                    
                    if (allUsers) {
                        const userCount = Object.keys(allUsers).length;
                        log(`👥 全体統計:`);
                        log(`- 登録ユーザー数: ${userCount}人`);
                        
                        let totalWeights = 0;
                        Object.values(allUsers).forEach(user => {
                            if (user.weights) {
                                totalWeights += Object.keys(user.weights).length;
                            }
                        });
                        log(`- 全体の体重記録数: ${totalWeights}件`);
                    }
                } catch (error) {
                    log(`⚠️ 全体統計の取得に制限があります: ${error.message}`);
                }
                
            } catch (error) {
                log(`❌ 構造確認エラー: ${error.message}`);
            }
            
            log('🏗️ === データベース構造確認 完了 ===');
        };

        // デバッグ情報をコピー
        window.copyDebugInfo = () => {
            const debugInfo = `体重管理アプリ デバッグ情報
=================================
タイムスタンプ: ${new Date().toLocaleString()}
URL: ${window.location.href}
プロトコル: ${window.location.protocol}
ドメイン: ${window.location.hostname}
ユーザーエージェント: ${navigator.userAgent}

Firebase設定:
- プロジェクトID: ${firebaseConfig.projectId}
- データベースURL: ${firebaseConfig.databaseURL}
- 認証ドメイン: ${firebaseConfig.authDomain}

認証状態: ${currentUser ? 'ログイン済み' : '未ログイン'}
${currentUser ? `- UID: ${currentUser.uid.substring(0,8)}...\n- Email: ${currentUser.email}\n- 表示名: ${currentUser.displayName}` : ''}

Firebase SDK: ${typeof firebase !== 'undefined' ? '読み込み済み' : '読み込みエラー'}
Web Storage: ${(() => {
    try {
        localStorage.setItem('test', 'test');
        localStorage.removeItem('test');
        return '利用可能';
    } catch (e) {
        return '無効';
    }
})()}

ログ内容:
${document.getElementById('logArea').innerText}`;

            navigator.clipboard.writeText(debugInfo).then(() => {
                alert('✅ デバッグ情報をコピーしました');
            }).catch(() => {
                // fallback
                const textArea = document.createElement('textarea');
                textArea.value = debugInfo;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('✅ デバッグ情報をコピーしました');
            });
        };

        // アプリ初期化
        function initializeApp() {
            // バージョン表示の動的設定
            document.title = `体重管理アプリ ${APP_VERSION}`;
            document.getElementById('appTitle').textContent = `📊 体重管理アプリ ${APP_VERSION}`;
            
            log(`🚀 体重管理アプリ起動完了 ${APP_VERSION}`);
            log('🔐 認証システム準備完了');
        }

        // 初期化実行
        initializeApp();
        
        // プロトコルチェック（自動診断）
        if (window.location.protocol === 'file:') {
            log('⚠️ file://プロトコル検出 - Googleログインには HTTPサーバーが必要です');
            log('💡 解決方法: python -m http.server 8000 または chrome://flags設定');
        }

        // ========== 睡眠管理機能 ==========
        // 睡眠管理機能は tabs/tab2-sleep/tab-sleep.js に移動済み

        // ========== 部屋片付け機能 ==========
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        


    </script>
</body>
</html>
