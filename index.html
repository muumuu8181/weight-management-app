
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>体重管理アプリ v2.59</title>
    
    <!-- カスタムスタイル -->
    <link rel="stylesheet" href="custom/styles.css">
    
    <!-- タブ固有スタイル -->
    <link rel="stylesheet" href="tabs/tab3-room-cleaning/room-cleaning.css">
    <link rel="stylesheet" href="tabs/tab4-stretch/tab-stretch.css">
    <link rel="stylesheet" href="tabs/tab6-job-dc/tab6-job-dc.css">
    <link rel="stylesheet" href="tabs/tab7-pedometer/tab-pedometer.css">
    <link rel="stylesheet" href="tabs/tab8-memo-list/memo-list.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <!-- Chart.js with date adapter -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    
    <!-- カスタム設定 -->
    <script type="module" src="custom/app-config.js"></script>
    
    <!-- タブ設定 -->
    <script src="shared/configs/tab-config.js"></script>
    
    <!-- タブシステム管理 -->
    <script src="shared/core/tab-system.js"></script>
    
    <!-- UI制御ユーティリティ -->
    <script src="shared/utils/ui-controls.js"></script>
    <script src="shared/utils/field-validation.js"></script>
    <script src="shared/utils/function-analyzer.js"></script>
    
    <!-- Firebase初期化 -->
    <script src="shared/core/firebase-init.js"></script>
    
    <!-- 認証システム -->
    <script src="shared/core/auth-system.js"></script>
    
    <!-- 共通JavaScript関数 -->
    <script src="shared/common-functions.js"></script>
    
    <!-- 共通ユーティリティ -->
    <script src="shared/utils/firebase-crud.js"></script>
    <script src="shared/utils/validation.js"></script>
    <script src="shared/utils/custom-items.js"></script>
    <script src="shared/utils/data-operations.js"></script>
    <script src="shared/utils/data-analytics.js"></script>
    <script src="shared/utils/firebase-multi-loader.js"></script>
    <script src="shared/utils/improvement-advisor.js"></script>
    
    <!-- 共通コンポーネント -->
    <script src="shared/components/dom-utils.js"></script>
    <script src="shared/components/mode-control.js"></script>
    <script src="shared/components/time-tracker.js"></script>
    <script src="shared/components/unified-selection.js"></script>
    <script src="shared/components/universal-task-manager.js"></script>
    <script src="shared/components/dashboard-builder.js"></script>
    
    <!-- 認証・デバッグ・ログ関数 -->
    <script src="shared/core/auth.js"></script>
    <script src="shared/utils/debug.js"></script>
    <script src="shared/utils/logging.js"></script>
    
    <!-- エフェクトシステム -->
    <script src="shared/effects/simple-effects.js"></script>
    <script src="shared/effects/smart-effects-manager.js"></script>
    
    <!-- 外部CSSファイル -->
    <link rel="stylesheet" href="shared/styles/app-layout.css">
    <link rel="stylesheet" href="shared/styles/timing-clothing-buttons.css">
    <link rel="stylesheet" href="shared/styles/field-badges.css">
    <link rel="stylesheet" href="shared/styles/function-badges.css">
    <link rel="stylesheet" href="shared/styles/analytics-cards.css">
    
    <!-- タブ固有JavaScript -->
    <!-- タブ用JSは動的読み込みのためstatic読み込み削除 -->
</head>
<body>
    <div class="container">
        <!-- ユーザー情報表示（一番上） -->
        <div class="user-info hidden" id="userInfo" style="margin-bottom: 10px;">
            <span>👤 ログイン中: <span id="userName"></span></span>
            <button class="logout-button" onclick="handleLogout()">ログアウト</button>
        </div>

        <!-- タブナビゲーション（動的生成） -->
        <div id="tabNavigation" class="hidden" style="margin-bottom: 15px;">
        </div>

        <!-- アプリタイトル -->
        <div class="app-header hidden" id="appHeader">
            <h1 class="app-title" id="appTitle">📊 体重管理アプリ</h1>
            <p class="app-subtitle">Core/Customフォルダ分離版 - Firebase + Google認証</p>
        </div>

        <!-- 認証セクション -->
        <div class="auth-section" id="authSection">
            <h1 class="app-title">📊 体重管理アプリ</h1>
            <p class="app-subtitle">Core/Customフォルダ分離版 - Firebase + Google認証</p>
            <h3>🔐 ログイン</h3>
            <p>Googleアカウントでログインしてデータを保存・同期できます</p>
            <button class="auth-button" onclick="handleGoogleLogin()">Googleでログイン</button>
        </div>

        <!-- タブコンテンツ -->
        <div id="tabContent1" class="tab-content">
            <!-- 体重管理コンテンツは動的読み込み -->
        </div>

        <!-- 共通ログエリア（全タブ用） -->
        <div class="hidden" id="globalLogArea">
            <h3>📋 アプリログ <button class="universal-copy-btn" onclick="copyLogs()" style="background: #28a745; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 12px;">📋 ログをコピー</button></h3>
            <div class="data-area" id="logArea">
                アプリテンプレート起動完了...<br>
                🔥 Firebase設定完了<br>
                🔐 Google認証準備完了<br>
            </div>
            
            <!-- デバッグボタンエリア -->
            <div style="margin-top: 8px; text-align: center;">
                <button class="universal-copy-btn" onclick="debugFirebaseConnection()" style="background: #ff6b6b; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">🔍 Firebase Debug</button>
                <button class="universal-copy-btn" onclick="checkLoginIssues()" style="background: #ffc107; color: #212529; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">⚠️ ログイン問題診断</button>
                <button class="universal-copy-btn" onclick="copyDebugInfo()" style="background: #17a2b8; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">📋 デバッグ情報をコピー</button>
                <button class="universal-copy-btn" onclick="checkDatabaseStructure()" style="background: #6f42c1; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">🏗️ DB構造確認</button>
                <button class="universal-copy-btn" onclick="checkMobileSupport()" style="background: #28a745; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">📱 モバイル診断</button>
                <button class="universal-copy-btn" onclick="forceAuthCheck()" style="background: #fd7e14; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">🔄 認証状態確認</button>
                <button class="universal-copy-btn" onclick="checkFirebaseConfig()" style="background: #dc3545; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">🔧 Firebase設定</button>
                <button class="universal-copy-btn" onclick="testPopup()" style="background: #20c997; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin: 5px;">🧪 ポップアップテスト</button>
            </div>
        </div>
        <!-- タブコンテンツ2 -->
        <div id="tabContent2" class="tab-content hidden">
            <!-- コンテンツは動的読み込み -->
        </div>

        <!-- タブコンテンツ3 -->
        <div id="tabContent3" class="tab-content hidden">
            <!-- コンテンツは動的読み込み -->
        </div>

        <!-- タブコンテンツ4: ストレッチ -->
        <div id="tabContent4" class="tab-content hidden">
            <!-- ストレッチコンテンツは動的読み込み -->
        </div>

        <!-- タブコンテンツ5 -->
        <div id="tabContent5" class="tab-content hidden">
            <!-- コンテンツは動的読み込み -->
        </div>

        <!-- タブコンテンツ6 -->
        <div id="tabContent6" class="tab-content hidden">
            <!-- コンテンツは動的読み込み -->
        </div>

        <!-- タブコンテンツ7: 万歩計 -->
        <div id="tabContent7" class="tab-content hidden">
            <!-- コンテンツは動的読み込み -->
        </div>

        <!-- その他のタブコンテンツは動的生成 -->
        <div id="tabContent6" class="tab-content hidden"></div>
        <div id="tabContent7" class="tab-content hidden"></div>
        <div id="tabContent8" class="tab-content hidden"><!-- メモリスト動的読み込み --></div>
        <div id="tabContent9" class="tab-content hidden"></div>
        <div id="tabContent10" class="tab-content hidden"></div>
        <div id="tabContent11" class="tab-content hidden"></div>
        <div id="tabContent12" class="tab-content hidden"></div>
        <div id="tabContent13" class="tab-content hidden"></div>
        <div id="tabContent14" class="tab-content hidden"></div>
        <div id="tabContent15" class="tab-content hidden"></div>
        <div id="tabContent16" class="tab-content hidden"></div>
    </div>

    <script>
        // コアシステムは外部ファイルに分離済み
        // Firebase初期化: shared/core/firebase-init.js
        // 認証システム: shared/core/auth-system.js
        // タブシステム: shared/core/tab-system.js
        // UI制御: shared/utils/ui-controls.js
        
        // 現在のタブ管理変数
        let currentTab = 1;
        
        // アプリ初期化実行
        document.addEventListener('DOMContentLoaded', () => {
            // アプリ本体の初期化
            initializeApp();
            
            // 認証システム初期化
            initializeAuthSystem();
        });

    </script>
</body>
</html>
