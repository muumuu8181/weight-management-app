
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>ä½“é‡ç®¡ç†ã‚¢ãƒ—ãƒª</title>
    
    <!-- å¤–éƒ¨CSS -->
    <link rel="stylesheet" href="custom/styles.css">
    <link rel="stylesheet" href="tabs/tab3-room-cleaning/room-cleaning.css">
    <link rel="stylesheet" href="tabs/tab4-stretch/tab-stretch.css">
    <link rel="stylesheet" href="tabs/tab8-memo-list/memo-list.css">
    <link rel="stylesheet" href="shared/styles/app-layout.css">
    <link rel="stylesheet" href="shared/styles/timing-clothing-buttons.css">
    
    <!-- å¤–éƒ¨JS -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script type="module" src="custom/app-config.js"></script>
    <script src="shared/common-functions.js"></script>
    <script src="shared/utils/validation.js"></script>
    <script src="shared/utils/custom-items.js"></script>
    <script src="shared/utils/data-operations.js"></script>
    <script src="shared/components/dom-utils.js"></script>
    <script src="shared/components/mode-control.js"></script>
    <script src="shared/core/auth.js"></script>
    <script src="shared/utils/debug.js"></script>
    <script src="shared/utils/logging.js"></script>
</head>
<body>
    <div class="container">
        <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è¡¨ç¤ºï¼ˆä¸€ç•ªä¸Šï¼‰ -->
        <div class="user-info hidden" id="userInfo" style="margin-bottom: 10px;">
            <span>ğŸ‘¤ ãƒ­ã‚°ã‚¤ãƒ³ä¸­: <span id="userName"></span></span>
            <button class="logout-button" onclick="handleLogout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
        </div>

        <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div id="tabNavigation" class="hidden" style="margin-bottom: 15px;">
            <div id="tabRow1" class="tab-row"></div>
            <div id="tabRow2" class="tab-row"></div>
        </div>

        <!-- ã‚¢ãƒ—ãƒªã‚¿ã‚¤ãƒˆãƒ« -->
        <div class="app-header hidden" id="appHeader">
            <h1 class="app-title" id="appTitle">ğŸ“Š ä½“é‡ç®¡ç†ã‚¢ãƒ—ãƒª</h1>
            <p class="app-subtitle">Core/Customãƒ•ã‚©ãƒ«ãƒ€åˆ†é›¢ç‰ˆ - Firebase + Googleèªè¨¼</p>
        </div>

        <!-- èªè¨¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="auth-section" id="authSection">
            <h1 class="app-title">ğŸ“Š ä½“é‡ç®¡ç†ã‚¢ãƒ—ãƒª</h1>
            <p class="app-subtitle">Core/Customãƒ•ã‚©ãƒ«ãƒ€åˆ†é›¢ç‰ˆ - Firebase + Googleèªè¨¼</p>
            <h3>ğŸ” ãƒ­ã‚°ã‚¤ãƒ³</h3>
            <p>Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ãƒ»åŒæœŸã§ãã¾ã™</p>
            <button class="auth-button" onclick="handleGoogleLogin()">Googleã§ãƒ­ã‚°ã‚¤ãƒ³</button>
        </div>

        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <div id="tabContent1" class="tab-content">
            <!-- ä½“é‡ç®¡ç†ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯å‹•çš„èª­ã¿è¾¼ã¿ -->
        </div>

        <!-- å…±é€šãƒ­ã‚°ã‚¨ãƒªã‚¢ï¼ˆå…¨ã‚¿ãƒ–ç”¨ï¼‰ -->
        <div class="hidden" id="globalLogArea">
            <h3>ğŸ“‹ ã‚¢ãƒ—ãƒªãƒ­ã‚° <button class="universal-copy-btn" onclick="copyLogs()" style="background: #28a745; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 12px;">ğŸ“‹ ãƒ­ã‚°ã‚’ã‚³ãƒ”ãƒ¼</button></h3>
            <div class="data-area" id="logArea">
                ã‚¢ãƒ—ãƒªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆèµ·å‹•å®Œäº†...<br>
                ğŸ”¥ Firebaseè¨­å®šå®Œäº†<br>
                ğŸ” Googleèªè¨¼æº–å‚™å®Œäº†<br>
            </div>
            
            <div id="debugButtons" class="debug-button-grid"></div>
        </div>


        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„2 -->
        <div id="tabContent2" class="tab-content hidden">
            <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯å‹•çš„èª­ã¿è¾¼ã¿ -->
        </div>

        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„3 -->
        <div id="tabContent3" class="tab-content hidden">
            <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯å‹•çš„èª­ã¿è¾¼ã¿ -->
        </div>

        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„4: ã‚¹ãƒˆãƒ¬ãƒƒãƒ -->
        <div id="tabContent4" class="tab-content hidden">
            <!-- ã‚¹ãƒˆãƒ¬ãƒƒãƒã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯å‹•çš„èª­ã¿è¾¼ã¿ -->
        </div>

        <!-- å®Ÿè£…æ¸ˆã¿ã‚¿ãƒ–ï¼ˆå‹•çš„èª­ã¿è¾¼ã¿ï¼‰ -->
        <div id="tabContent5" class="tab-content hidden"></div>
        <div id="tabContent6" class="tab-content hidden"></div>
        <div id="tabContent7" class="tab-content hidden"></div>
        <div id="tabContent8" class="tab-content hidden"><!-- ãƒ¡ãƒ¢ãƒªã‚¹ãƒˆå‹•çš„èª­ã¿è¾¼ã¿ --></div>
        <div id="tabContent9" class="tab-content hidden"></div>
        <div id="tabContent10" class="tab-content hidden"></div>
        <div id="tabContent11" class="tab-content hidden"></div>
        <div id="tabContent12" class="tab-content hidden"></div>
        <div id="tabContent13" class="tab-content hidden"></div>
        <div id="tabContent14" class="tab-content hidden"></div>
        <div id="tabContent15" class="tab-content hidden"></div>
        <div id="tabContent16" class="tab-content hidden"></div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyA5PXKChizYDCXF_GJ4KL6Ylq9K5hCPXWE",
            authDomain: "shares-b1b97.firebaseapp.com",
            databaseURL: "https://shares-b1b97-default-rtdb.firebaseio.com",
            projectId: "shares-b1b97",
            storageBucket: "shares-b1b97.firebasestorage.app",
            messagingSenderId: "38311063248",
            appId: "1:38311063248:web:0d2d5726d12b305b24b8d5"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();
        let currentUser = null, currentTab = 1;
        const APP_VERSION = 'v2.13';
        // èªè¨¼çŠ¶æ…‹ã®ç›£è¦–ï¼ˆæ”¹è‰¯ç‰ˆ + ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå¯¾å¿œï¼‰
        auth.onAuthStateChanged(async (user) => {
            currentUser = user;
            if (user) {
                log(`âœ… èªè¨¼çŠ¶æ…‹ç¢ºèª: ${user.displayName} ã§ãƒ­ã‚°ã‚¤ãƒ³ä¸­`);
                log(`ğŸ“§ ãƒ¡ãƒ¼ãƒ«: ${user.email}`);
                showUserInterface(user);
                log('ğŸ”„ ä½“é‡ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ï¼ˆå¤–éƒ¨JSã§å®Ÿè¡Œï¼‰');
            } else {
                // ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆçµæœã‚’ãƒã‚§ãƒƒã‚¯ï¼ˆiPhoneå¯¾å¿œï¼‰
                try {
                    const result = await auth.getRedirectResult();
                    if (result.user) {
                        log(`âœ… ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ: ${result.user.displayName}`);
                    }
                } catch (error) {
                    // ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¨ãƒ©ãƒ¼ã¯ç„¡è¦–ï¼ˆåˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ãªã©ï¼‰
                }
                log('ğŸ”’ èªè¨¼çŠ¶æ…‹: æœªãƒ­ã‚°ã‚¤ãƒ³');
                showLoginInterface();
            }
        });

        // åˆæœŸåŒ–å®Œäº†ãƒ­ã‚°
        log('ğŸ”„ Firebaseèªè¨¼ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº† - èªè¨¼çŠ¶æ…‹ã‚’ç¢ºèªä¸­...');










        // ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å‹•çš„èª­ã¿è¾¼ã¿
        window.loadTabContent = async (tabNumber, tabType) => {
            try {
                const tabContentDiv = document.getElementById(`tabContent${tabNumber}`);
                if (!tabContentDiv) return;
                
                // HTMLã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’èª­ã¿è¾¼ã¿
                const response = await fetch(`tabs/tab${tabNumber}-${tabType}/tab-${tabType}.html`);
                if (response.ok) {
                    const htmlContent = await response.text();
                    tabContentDiv.innerHTML = htmlContent;
                    
                    // JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‹•çš„èª­ã¿è¾¼ã¿
                    await loadTabScript(tabNumber, tabType);
                    
                    // ã‚¿ãƒ–å›ºæœ‰ã®åˆæœŸåŒ–å‡¦ç†ï¼ˆJSãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿å®Œäº†å¾Œï¼‰
                    if (tabNumber === 1 && currentUser) {
                        log(`ğŸ”„ tab1: ä½“é‡ç®¡ç†ã‚¿ãƒ–åˆæœŸåŒ–å®Ÿè¡Œ`);
                        
                        // å¤–éƒ¨JSãƒ•ã‚¡ã‚¤ãƒ«ã®åˆæœŸåŒ–é–¢æ•°ã‚’å‘¼ã³å‡ºã—
                        setTimeout(() => {
                            if (typeof window.initWeightTab === 'function') {
                                window.initWeightTab();
                                log('âœ… ä½“é‡ç®¡ç†ã‚¿ãƒ–åˆæœŸåŒ–å®Œäº†');
                            } else {
                                log('âŒ initWeightTabé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                            }
                        }, 200);
                    } else if (tabNumber === 3 && currentUser) {
                        log('ğŸ”„ éƒ¨å±‹ç‰‡ä»˜ã‘ã‚¿ãƒ–: JSèª­ã¿è¾¼ã¿å®Œäº†å¾Œã®ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿é–‹å§‹');
                        setTimeout(() => {
                            if (typeof window.loadRoomData === 'function') {
                                window.loadRoomData();
                                log('âœ… éƒ¨å±‹ç‰‡ä»˜ã‘ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Ÿè¡Œ');
                            } else if (typeof loadRoomData === 'function') {
                                loadRoomData();
                                log('âœ… éƒ¨å±‹ç‰‡ä»˜ã‘ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Ÿè¡Œï¼ˆãƒ­ãƒ¼ã‚«ãƒ«é–¢æ•°ï¼‰');
                            } else {
                                log('âŒ loadRoomDataé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                            }
                        }, 200); // å°‘ã—é•·ã‚ã®å¾…æ©Ÿæ™‚é–“
                    } else if (tabNumber === 8 && currentUser) {
                        log('ğŸ”„ ãƒ¡ãƒ¢ãƒªã‚¹ãƒˆã‚¿ãƒ–: JSèª­ã¿è¾¼ã¿å®Œäº†å¾Œã®ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿é–‹å§‹');
                        setTimeout(() => {
                            loadMemoData();
                        }, 100);
                    }
                    
                    log(`âœ… ã‚¿ãƒ–${tabNumber}ï¼ˆ${tabType}ï¼‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„èª­ã¿è¾¼ã¿å®Œäº†`);
                } else {
                    log(`âš ï¸ ã‚¿ãƒ–${tabNumber}ã®åˆ†é›¢ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ - æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä½¿ç”¨`);
                }
            } catch (error) {
                log(`âŒ ã‚¿ãƒ–èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        };
        
        // ã‚¿ãƒ–ç”¨JavaScriptã®å‹•çš„èª­ã¿è¾¼ã¿
        window.loadTabScript = async (tabNumber, tabType) => {
            try {
                // æ—¢å­˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã‚’å‰Šé™¤
                const existingScript = document.getElementById(`tab${tabNumber}Script`);
                if (existingScript) {
                    existingScript.remove();
                }
                
                // æ–°ã—ã„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã‚’ä½œæˆ
                const script = document.createElement('script');
                script.id = `tab${tabNumber}Script`;
                script.src = `tabs/tab${tabNumber}-${tabType}/tab-${tabType}.js`;
                document.head.appendChild(script);
                
                return new Promise((resolve, reject) => {
                    script.onload = () => resolve();
                    script.onerror = () => reject(new Error(`Script load failed: ${script.src}`));
                });
            } catch (error) {
                throw error;
            }
        };

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ï¼ˆå‹•çš„èª­ã¿è¾¼ã¿å¯¾å¿œï¼‰
        window.switchTab = async (tabNumber) => {
            currentTab = tabNumber;
            
            // ç¾åœ¨ã®ã‚¿ãƒ–ã‚’ localStorage ã«ä¿å­˜
            localStorage.setItem('currentTab', tabNumber);
            
            // ã™ã¹ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ï¼ˆ16ã‚¿ãƒ–å¯¾å¿œï¼‰
            for (let i = 1; i <= 16; i++) {
                const tabBtn = document.getElementById(`tab${i}`);
                const tabContent = document.getElementById(`tabContent${i}`);
                
                log(`ğŸ” ã‚¿ãƒ–${i}: ãƒœã‚¿ãƒ³=${tabBtn ? 'å­˜åœ¨' : 'ãªã—'}, ã‚³ãƒ³ãƒ†ãƒ³ãƒ„=${tabContent ? 'å­˜åœ¨' : 'ãªã—'}`);
                
                if (i === tabNumber) {
                    // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ãƒ–
                    if (tabBtn) {
                        tabBtn.style.background = '#007bff';
                        tabBtn.style.color = 'white';
                    }
                    if (tabContent) {
                        tabContent.classList.remove('hidden');
                        log(`âœ… ã‚¿ãƒ–${i}ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º`);
                    }
                    
                    // å‹•çš„èª­ã¿è¾¼ã¿ï¼ˆå…¨åˆ†é›¢ã‚¿ãƒ–çµ±ä¸€ï¼‰
                    if (i === 1) {
                        await loadTabContent(1, 'weight');
                    } else if (i === 2) {
                        await loadTabContent(2, 'sleep');
                    } else if (i === 3) {
                        await loadTabContent(3, 'room-cleaning');
                    } else if (i === 4) {
                        await loadTabContent(4, 'stretch');
                    } else if (i === 8) {
                        await loadTabContent(8, 'memo-list');
                    }
                } else {
                    // éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ãƒ–
                    if (tabBtn) {
                        tabBtn.style.background = '#f8f9fa';
                        tabBtn.style.color = '#495057';
                    }
                    if (tabContent) {
                        tabContent.classList.add('hidden');
                        log(`âŒ ã‚¿ãƒ–${i}ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤º`);
                    }
                }
            }
            
            // ã‚¿ã‚¤ãƒˆãƒ«æ›´æ–°
            const tabTitles = {
                1: 'ğŸ“Š ä½“é‡ç®¡ç†ã‚¢ãƒ—ãƒª',
                2: 'ğŸ›ï¸ ç¡çœ ç®¡ç†',
                3: 'ğŸ  éƒ¨å±‹ç‰‡ã¥ã‘',
                4: 'ğŸ¤¸ ã‚¹ãƒˆãƒ¬ãƒƒãƒ',
                5: 'ğŸ”§ xx5',
                6: 'ğŸ”§ xx6', 
                7: 'ğŸ”§ xx7',
                8: 'ğŸ“ ãƒ¡ãƒ¢ãƒªã‚¹ãƒˆ'
            };
            
            const titleElement = document.getElementById('appTitle');
            if (titleElement && tabTitles[tabNumber]) {
                titleElement.textContent = `${tabTitles[tabNumber]} ${APP_VERSION}`;
            }
            
            // ä½“é‡ç®¡ç†è¦ç´ ã¯å¸¸ã«è¡¨ç¤ºï¼ˆtabContent1å†…ã«ã‚ã‚‹ãŸã‚è‡ªå‹•åˆ¶å¾¡ã•ã‚Œã‚‹ï¼‰
            
            // ã‚¿ãƒ–å›ºæœ‰ã®åˆæœŸåŒ–å‡¦ç†
            if (tabNumber === 1) {
                // ä½“é‡ç®¡ç†ã‚¿ãƒ–ã®åˆæœŸåŒ–ï¼ˆå¤–éƒ¨JSã§å‡¦ç†ï¼‰
                if (currentUser && typeof window.initWeightTab === 'function') {
                    log('ğŸ”„ ä½“é‡ç®¡ç†ã‚¿ãƒ–: å¤–éƒ¨JSåˆæœŸåŒ–å®Ÿè¡Œ');
                    window.initWeightTab();
                }
            } else if (tabNumber === 2) {
                // ç¡çœ ç®¡ç†ã‚¿ãƒ–ã®åˆæœŸåŒ–ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ã«é–¢ä¿‚ãªãå®Ÿè¡Œï¼‰
                initializeSleepManager();
                if (currentUser) {
                    loadSleepData();
                }
            } else if (tabNumber === 3) {
                // éƒ¨å±‹ç‰‡ä»˜ã‘ã‚¿ãƒ–ã®åˆæœŸåŒ–ï¼ˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã¯loadTabContentå®Œäº†å¾Œã«å®Ÿè¡Œï¼‰
                log('ğŸ”„ éƒ¨å±‹ç‰‡ä»˜ã‘ã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ãˆ - åˆæœŸåŒ–ã®ã¿å®Ÿè¡Œ');
                initRoomManagement();
            } else if (tabNumber === 8) {
                // ãƒ¡ãƒ¢ãƒªã‚¹ãƒˆã‚¿ãƒ–ã®åˆæœŸåŒ–ï¼ˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã¯loadTabContentå®Œäº†å¾Œã«å®Ÿè¡Œï¼‰
                log('ğŸ”„ ãƒ¡ãƒ¢ãƒªã‚¹ãƒˆã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ãˆ - åˆæœŸåŒ–ã®ã¿å®Ÿè¡Œ');
            }
            
            log(`ğŸ“‘ ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ: ã‚¿ãƒ–${tabNumber}`);
        };

        // UIè¡¨ç¤ºåˆ¶å¾¡
        function showUserInterface(user) {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('tabNavigation').classList.remove('hidden');
            document.getElementById('appHeader').classList.remove('hidden');
            // ä½“é‡ç®¡ç†é–¢é€£è¦ç´ ã¯å­˜åœ¨ãƒã‚§ãƒƒã‚¯å¾Œã«è¡¨ç¤º
            const modeControl = document.getElementById('modeControl');
            if (modeControl) modeControl.classList.remove('hidden');
            
            const weightInput = document.getElementById('weightInput');
            if (weightInput) weightInput.classList.remove('hidden');
            
            const chartPanel = document.getElementById('chartPanel');
            if (chartPanel) chartPanel.classList.remove('hidden');
            
            const weightHistoryPanel = document.getElementById('weightHistoryPanel');
            if (weightHistoryPanel) weightHistoryPanel.classList.remove('hidden');
            document.getElementById('userName').textContent = user.displayName;
            
            // ä¿å­˜ã•ã‚ŒãŸã‚¿ãƒ–ã¾ãŸã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚¿ãƒ–1ã‚’è¡¨ç¤º
            const savedTab = localStorage.getItem('currentTab');
            const tabToShow = savedTab ? parseInt(savedTab) : 1;
            switchTab(tabToShow);
            
            // æ—¥ä»˜åˆæœŸåŒ–ã¯å„ã‚¿ãƒ–ã®å¤–éƒ¨JSãƒ•ã‚¡ã‚¤ãƒ«ã§å®Ÿè¡Œ
            
            // ãƒ¡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ï¼ˆãƒ­ã‚°ã‚¤ãƒ³æ™‚ã€å­˜åœ¨ãƒã‚§ãƒƒã‚¯ä»˜ãï¼‰
            if (typeof loadMemoData === 'function') {
                loadMemoData();
                log('âœ… ãƒ¡ãƒ¢ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Ÿè¡Œ');
            } else {
                log('âš ï¸ loadMemoDataé–¢æ•°æœªå®šç¾© - åˆæœŸåŒ–æ™‚ã‚¹ã‚­ãƒƒãƒ—');
            }
            
            // ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒœã‚¿ãƒ³ã®åˆæœŸçŠ¶æ…‹è¨­å®š
            document.querySelectorAll('.timing-btn').forEach(btn => {
                btn.style.opacity = '0.7';
                btn.classList.remove('selected');
            });
            
            // æœè£…ãƒœã‚¿ãƒ³ã®åˆæœŸçŠ¶æ…‹è¨­å®š
            document.querySelectorAll('.clothing-btn').forEach(btn => {
                btn.style.opacity = '0.7';
                btn.style.transform = 'scale(1)';
            });
            
            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœè£…é¸æŠï¼ˆå¤–éƒ¨JSãƒ•ã‚¡ã‚¤ãƒ«ã§å®Ÿè¡Œï¼‰
            
        }

        function showLoginInterface() {
            document.getElementById('authSection').classList.remove('hidden');
            document.getElementById('userInfo').classList.add('hidden');
            document.getElementById('tabNavigation').classList.add('hidden');
            document.getElementById('appHeader').classList.add('hidden');
            document.getElementById('modeControl').classList.add('hidden');
            document.getElementById('weightInput').classList.add('hidden');
            document.getElementById('chartPanel').classList.add('hidden');
        }


        // ã‚¢ãƒ—ãƒªåˆæœŸåŒ–
        function initializeApp() {
            // ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡¨ç¤ºã®å‹•çš„è¨­å®š
            document.title = `ä½“é‡ç®¡ç†ã‚¢ãƒ—ãƒª ${APP_VERSION}`;
            document.getElementById('appTitle').textContent = `ğŸ“Š ä½“é‡ç®¡ç†ã‚¢ãƒ—ãƒª ${APP_VERSION}`;
            
            log(`ğŸš€ ä½“é‡ç®¡ç†ã‚¢ãƒ—ãƒªèµ·å‹•å®Œäº† ${APP_VERSION}`);
            log('ğŸ” èªè¨¼ã‚·ã‚¹ãƒ†ãƒ æº–å‚™å®Œäº†');
        }

        // åˆæœŸåŒ–å®Ÿè¡Œ
        initializeApp();
        
        // ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒã‚§ãƒƒã‚¯ï¼ˆè‡ªå‹•è¨ºæ–­ï¼‰
        if (window.location.protocol === 'file:') {
            log('âš ï¸ file://ãƒ—ãƒ­ãƒˆã‚³ãƒ«æ¤œå‡º - Googleãƒ­ã‚°ã‚¤ãƒ³ã«ã¯ HTTPã‚µãƒ¼ãƒãƒ¼ãŒå¿…è¦ã§ã™');
            log('ğŸ’¡ è§£æ±ºæ–¹æ³•: python -m http.server 8000 ã¾ãŸã¯ chrome://flagsè¨­å®š');
        }

    </script>
</body>
</html>
